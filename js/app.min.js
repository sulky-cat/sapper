(()=>{"use strict";let t=!0,e=(t=500)=>{document.documentElement.classList.contains("lock")?s(t):o(t)},s=(e=500)=>{let s=document.querySelector("body");if(t){let o=document.querySelectorAll("[data-lp]");setTimeout((()=>{for(let t=0;t<o.length;t++){o[t].style.paddingRight=""}s.style.paddingRight="",document.documentElement.classList.remove("lock")}),e),t=!1,setTimeout((function(){t=!0}),e)}},o=(e=500)=>{let s=document.querySelector("body");if(t){let o=document.querySelectorAll("[data-lp]");for(let t=0;t<o.length;t++){o[t].style.paddingRight=window.innerWidth-document.body.offsetWidth+"px"}s.style.paddingRight=window.innerWidth-document.body.offsetWidth+"px",document.documentElement.classList.add("lock"),t=!1,setTimeout((function(){t=!0}),e)}};new class{constructor(t){let e={attributeOpenButton:"data-popup",attributeCloseButton:"data-close",youtubeAttribute:"data-youtube",youtubePlaceAttribute:"data-youtube-place",setAutoplayYoutube:!0,classes:{popup:"popup",popupContent:"popup__content",popupActive:"popup_show",bodyActive:"popup-show"},focusCatch:!0,closeEsc:!0,bodyLock:!0,bodyLockDelay:500,hashSettings:{location:!0,goHash:!0},on:{beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}}};this.isOpen=!1,this.lockBeforeOpen=!1,this.targetOpen={selector:!1,element:!1},this.previousOpen={selector:!1,element:!1},this.lastClosed={selector:!1,element:!1},this._dataValue=!1,this.hash=!1,this._reopen=!1,this._selectorOpen=!1,this.lastFocusEl=!1,this._focusEl=["a[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"button:not([disabled]):not([aria-hidden])","select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","area[href]","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.options={...e,...t,classes:{...e.classes,...t?.classes},hashSettings:{...e.hashSettings,...t?.hashSettings},on:{...e.on,...t?.on}},this.initPopups()}initPopups(){this.eventsPopup()}eventsPopup(){document.addEventListener("click",function(e){const s=e.target.closest(`[${this.options.attributeOpenButton}]`);if(s&&t)return e.preventDefault(),this._dataValue=s.getAttribute(this.options.attributeOpenButton)?s.getAttribute(this.options.attributeOpenButton):"error",this.youtubeCode=s.hasAttribute(this.options.youtubeAttribute)?s.getAttribute(this.options.youtubeAttribute):null,"error"!==this._dataValue?(this.isOpen||(this.lastFocusEl=s),this.targetOpen.selector=`${this._dataValue}`,this._selectorOpen=!0,void this.open()):void 0;return e.target.closest(`[${this.options.attributeCloseButton}]`)||!e.target.closest(`.${this.options.classes.popupContent}`)&&this.isOpen?(e.preventDefault(),void this.close()):void 0}.bind(this)),document.addEventListener("keydown",function(t){if(this.options.closeEsc&&27==t.which&&"Escape"===t.code&&this.isOpen)return t.preventDefault(),void this.close();this.options.focusCatch&&9==t.which&&this.isOpen&&this._focusCatch(t)}.bind(this)),document.querySelector("form[data-ajax],form[data-dev]")&&document.addEventListener("formSent",function(t){const e=t.detail.form.dataset.popupMessage;e&&this.open(e)}.bind(this)),this.options.hashSettings.goHash&&(window.addEventListener("hashchange",function(){window.location.hash?this._openToHash():this.close(this.targetOpen.selector)}.bind(this)),window.addEventListener("load",function(){window.location.hash&&this._openToHash()}.bind(this)))}open(t){if(document.documentElement.classList.contains("lock")&&!this.isOpen&&(this.lockBeforeOpen=!0),t&&"string"==typeof t&&""!==t.trim()&&(this.targetOpen.selector=t,this._selectorOpen=!0),document.documentElement.classList.contains("lock")&&(this._reopen=!0,this.isOpen&&this.close()),this._selectorOpen||(this.targetOpen.selector=this.lastClosed.selector),this._reopen||(this.previousActiveElement=document.activeElement),this.targetOpen.element=document.querySelector(this.targetOpen.selector),this.targetOpen.element){if(this.youtubeCode){const t=`https://www.youtube.com/embed/${this.youtubeCode}?rel=0&showinfo=0&autoplay=1`,e=document.createElement("iframe");e.setAttribute("allowfullscreen","");const s=this.options.setAutoplayYoutube?"autoplay;":"";e.setAttribute("allow",`${s}; encrypted-media`),e.setAttribute("src",t),this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)&&this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).appendChild(e)}this.options.hashSettings.location&&(this._getHash(),this._setHash()),this.options.on.beforeOpen(this),this.targetOpen.element.classList.add(this.options.classes.popupActive),document.body.classList.add(this.options.classes.bodyActive),this._reopen?this._reopen=!1:e(),this.targetOpen.element.setAttribute("aria-hidden","false"),this.previousOpen.selector=this.targetOpen.selector,this.previousOpen.element=this.targetOpen.element,this._selectorOpen=!1,this.isOpen=!0,setTimeout((()=>{this._focusTrap()}),50),this.options.on.afterOpen(this),document.dispatchEvent(new CustomEvent("afterPopupOpen",{detail:{popup:this}}))}}close(s){s&&"string"==typeof s&&""!==s.trim()&&(this.previousOpen.selector=s),this.isOpen&&t&&(this.options.on.beforeClose(this),this.youtubeCode&&this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)&&(this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).innerHTML=""),this.previousOpen.element.classList.remove(this.options.classes.popupActive),this.previousOpen.element.setAttribute("aria-hidden","true"),this._reopen||(document.body.classList.remove(this.options.classes.bodyActive),this.lockBeforeOpen||e(),this.isOpen=!1),this._removeHash(),this._selectorOpen&&(this.lastClosed.selector=this.previousOpen.selector,this.lastClosed.element=this.previousOpen.element),this.options.on.afterClose(this),document.dispatchEvent(new CustomEvent("afterPopupClose",{detail:{popup:this}})),setTimeout((()=>{this._focusTrap()}),50))}_getHash(){this.options.hashSettings.location&&(this.hash=this.targetOpen.selector.includes("#")?this.targetOpen.selector:this.targetOpen.selector.replace(".","#"))}_openToHash(){let t=document.querySelector(`.${window.location.hash.replace("#","")}`)?`.${window.location.hash.replace("#","")}`:document.querySelector(`${window.location.hash}`)?`${window.location.hash}`:null;const e=document.querySelector(`[${this.options.attributeOpenButton}="${t}"]`),s=document.querySelector(t);(e||s)&&t&&this.open(t)}_setHash(){history.pushState("","",this.hash)}_removeHash(){history.pushState("","",window.location.href.split("#")[0])}_focusCatch(t){const e=this.targetOpen.element.querySelectorAll(this._focusEl),s=Array.prototype.slice.call(e),o=s.indexOf(document.activeElement);t.shiftKey&&0===o&&(s[s.length-1].focus(),t.preventDefault()),t.shiftKey||o!==s.length-1||(s[0].focus(),t.preventDefault())}_focusTrap(){const t=this.previousOpen.element.querySelectorAll(this._focusEl);!this.isOpen&&this.lastFocusEl?this.lastFocusEl.focus():t[0].focus()}}({hashSettings:{location:!1}}).open("#start");const n=document.querySelector(".sapper");if(n){const i=document.querySelector(".sapper__grid"),a=n.querySelector(".sapper__flag");let l=8,r=10,c=d(n,l,r),u=c[0],p=c[1],h=c[2];function d(t,e,s){t.classList.remove("sapper_win"),t.classList.remove("sapper_game-over"),i.innerHTML="";const o=v(Math.pow(e,2),Math.pow(e,2)),n={id:L(e,s,o)[0]};g(i,e);const a={id:_(i,o)[0],element:_(i,o)[1]};return y(e,a.element),[o,n,a]}function m(t,e){for(let s=0;s<e.length;s++)for(let o=0;o<e.length;o++)if(e[s][o]==t)return[s,o]}function f(t,e,s,o){if(!1!==t&&!1!==e&&t<o&&e<o&&t>=0&&e>=0)return s[t][e]}function b(t,e){const s=document.createElement("div");s.classList.add("sapper__button"),s.setAttribute("data-sapper",t),s.setAttribute("type","button");const o=100/Math.sqrt(e);return s.style.width=`${o}%`,s.style.height=`${o}%`,s}function g(t,e){const s=Math.pow(e,2);t.innerHTML="";for(let e=0;e<s;e++){const o=b(e,s);t.insertAdjacentElement("beforeend",o)}}function _(t,e){let s=[],o=[];const n=Array.from(t.children);return n.map((t=>{s.push(Number(t.dataset.sapper)),o.push(m(Number(t.dataset.sapper),e))})),[s,n,o]}function v(t){let e=0,s=0,o=[],n=[];for(let i=0;i<=t;i++)s>=Math.sqrt(t)&&(o[e]=n.slice(),e++,s=0),n[s]=i,s++;return o}function y(t,e){let s=0;for(let o=0;o<t;o++)for(let n=0;n<t;n++)O(e[s],o,n),s++}function O(t,e,s){t.style.transform=`translate3D(${100*s}%,${100*e}%,0)`}function L(t,e,s){let o=[],n=[];const i=Math.pow(t,2);for(;o.length<e;){let t=Math.floor(Math.random()*i);o.includes(t)||(o.push(t),n.push(m(t,s)))}return[o,n]}function w(t,e,s,o,n,i,a=!1){if(n.element[e].classList.contains("sapper__button_open"))return;if(a&&n.element[e].classList.remove("sapper__button_question"),s.id.includes(e))return a?void n.element[e].classList.add("sapper__button_bomb"):void n.id.forEach((e=>{t.classList.add("sapper_game-over"),w(t,e,s,o,n,i,!0)}));const l=m(e,i);let r=0,c=[];for(let t=-1;t<2;t++)for(let e=-1;e<2;e++)c.push(f(l[0]+t,l[1]+e,i,o));c.forEach((t=>{void 0!==t&&t!==e&&s.id.includes(t)&&++r})),n.element[e].classList.add("sapper__button_open"),n.element[e].classList.remove("sapper__button_question"),r&&(n.element[e].textContent=r),0!==r||a||c.forEach((a=>{void 0!==a&&a!==e&&void 0!==a&&a!==e&&w(t,a,s,o,n,i,!1)})),a||E(t,n,s)}function E(t,e,s){let o=0;for(let n=0;n<e.element.length;n++){const i=e.element[n];if(!s.id.includes(Number(i.dataset.sapper))){if(!i.classList.contains("sapper__button_open"))return;++o,o===e.id.length-s.id.length&&t.classList.add("sapper_win")}}}n.addEventListener("click",(t=>{const e=t.target;if(e.closest(".sapper__button")&&!n.classList.contains("sapper_game-over"))if("off"===a.dataset.flag){const t=Number(e.closest(".sapper__button").dataset.sapper);w(n,t,p,l,h,u)}else"on"===a.dataset.flag&&e.closest(".sapper__button").classList.toggle("sapper__button_question");if(e.closest(".sapper__flag")){const t=e.closest(".sapper__flag");"off"===t.dataset.flag?t.setAttribute("data-flag","on"):"on"===t.dataset.flag&&t.setAttribute("data-flag","off")}e.closest(".sapper__start")&&(c=d(n,l,r),u=c[0],p=c[1],h=c[2])})),n.addEventListener("contextmenu",(t=>{if(!n.classList.contains("sapper_game-over")){t.preventDefault();const e=t.target;e.closest(".sapper__button")&&e.closest(".sapper__button").classList.toggle("sapper__button_question")}}));const A=document.querySelector(".settings");if(A){const q=document.body;A.addEventListener("click",(t=>{const e=t.target;if(e.closest("[data-theme]")){S(e.dataset.theme,q)}e.closest("[data-local]")&&(localStorage.clear(),document.location.reload()),e.closest("[data-size]")&&(l=Number(e.dataset.size),c=d(n,l,r),u=c[0],p=c[1],h=c[2])}));const C=A.querySelector("input");C.addEventListener("input",(()=>{let t=C.value;t<0?C.value=1:t>Math.pow(l,2)-1&&(C.value=Math.pow(l,2)-1),r=Number(C.value);let e=setTimeout((()=>{clearTimeout(e),c=d(n,l,r),u=c[0],p=c[1],h=c[2]}),500)}))}function S(t,e){switch(t){case"dark":e.classList.remove("theme-light"),e.classList.add("theme-dark"),localStorage.setItem("theme","dark");break;case"light":e.classList.remove("theme-dark"),e.classList.add("theme-light"),localStorage.setItem("theme","light")}}}window.addEventListener("DOMContentLoaded",(()=>{document.body})),document.addEventListener("click",(t=>{const e=t.target;e.closest(".settings")||e.closest(".gear")||!document.documentElement.classList.contains("menu-open")||(s(),document.documentElement.classList.remove("menu-open"))})),function(){let s=document.querySelector(".gear");s&&s.addEventListener("click",(function(s){t&&(e(),document.documentElement.classList.toggle("menu-open"))}))}()})();